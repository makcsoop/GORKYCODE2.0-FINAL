"""
–ú–æ–¥—É–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–ª–æ–∂–Ω—ã—Ö –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–≤–µ—Ç —Å–ª–æ–∂–Ω—ã–º –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–º
"""

import json
import openai
from typing import Optional, Dict, List

# API –∫–ª—é—á OpenAI (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ, —á—Ç–æ –∏ –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö)
OPENAI_API_KEY = ""

# –ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
OPENAI_MODEL = "gpt-4o-mini"

# –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç OpenAI
client = openai.OpenAI(api_key=OPENAI_API_KEY)


def is_bureaucratic_response(text: str) -> Dict:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–≤–µ—Ç —Å–ª–æ–∂–Ω—ã–º –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–º
    
    Args:
        text: –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∞–Ω–∞–ª–∏–∑–∞:
        {
            "is_bureaucratic": 0 –∏–ª–∏ 1,
            "confidence": "–≤—ã—Å–æ–∫–∞—è/—Å—Ä–µ–¥–Ω—è—è/–Ω–∏–∑–∫–∞—è",
            "reason": "–∫—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ",
            "complexity_score": 0-100 (–æ—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏),
            "success": True/False,
            "error": "—Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ" (–µ—Å–ª–∏ success=False)
        }
    """
    if not text or not text.strip():
        return {
            "is_bureaucratic": 0,
            "confidence": "–Ω–∏–∑–∫–∞—è",
            "reason": "–ø—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç",
            "complexity_score": 0,
            "success": True,
            "error": None
        }
    
    prompt = f"""–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–ª–µ–¥—É—é—â–∏–π —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–Ω —Å–ª–æ–∂–Ω—ã–º –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç–≤–µ—Ç–æ–º.

–°–ª–æ–∂–Ω—ã–π –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –õ–Æ–ë–´–ú –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤, —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤, –∫–∞–Ω—Ü–µ–ª—è—Ä–∏–∑–º–æ–≤
- –ú–Ω–æ–≥–æ—Å–ª–æ–≤–Ω–æ—Å—Ç—å –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ (–¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –æ–±—â–∏–µ —Ñ—Ä–∞–∑—ã)
- –û—Ç—Å—ã–ª–∫–∏ –∫ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –∞–∫—Ç–∞–º, —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞–º, –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å—É—Ç–∏
- –§–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ—Ç–ø–∏—Å–∫–∏ —Ç–∏–ø–∞ "–±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ", "–ø—Ä–∏–Ω—è—Ç–æ –∫ —Å–≤–µ–¥–µ–Ω–∏—é", "–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ"
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –∑–∞–ª–æ–≥–∞ –∏ —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π ("–æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è", "–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è", "–ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –º–µ—Ä—ã")
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏–ª–∏ —Å—Ä–æ–∫–æ–≤
- –®–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã —Ç–∏–ø–∞ "–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å", "–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏", "–≤ —Ä–∞–º–∫–∞—Ö", "–≤ —Ü–µ–ª—è—Ö"
- –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π
- –û—Ç–≤–µ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –≤–æ–ø—Ä–æ—Å, –∞ —É—Ö–æ–¥–∏—Ç –≤ –æ–±—â–∏–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è
- –¢–µ–∫—Å—Ç –¥–ª–∏–Ω–Ω—ã–π, –Ω–æ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

–ü—Ä–∏–º–µ—Ä—ã –°–õ–û–ñ–ù–´–• –ë–Æ–†–û–ö–†–ê–¢–ò–ß–ï–°–ö–ò–• –æ—Ç–≤–µ—Ç–æ–≤:
1. "–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–µ–π—Å—Ç–≤—É—é—â–∏–º –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–æ–≤—ã–º–∏ –∞–∫—Ç–∞–º–∏, —Ä–µ–≥—É–ª–∏—Ä—É—é—â–∏–º–∏ –≤–æ–ø—Ä–æ—Å—ã –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–ª–∞–Ω–∞ —Ä–∞–±–æ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –æ—Ç—á–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Å —É—á–µ—Ç–æ–º –∏–º–µ—é—â–∏—Ö—Å—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è –≥–æ—Ä–æ–¥—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã."
2. "–ü–æ –≤–æ–ø—Ä–æ—Å—É, –∏–∑–ª–æ–∂–µ–Ω–Ω–æ–º—É –≤ –æ–±—Ä–∞—â–µ–Ω–∏–∏, —Å–æ–æ–±—â–∞–µ–º, —á—Ç–æ –≤ —Ä–∞–º–∫–∞—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é –æ–±—ä–µ–∫—Ç–æ–≤ –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –º–µ—Ä—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –Ω–∞–¥–ª–µ–∂–∞—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏."
3. "–í–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ –∫ —Å–≤–µ–¥–µ–Ω–∏—é. –í–æ–ø—Ä–æ—Å –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω –ø—Ä–∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞ —Ä–∞–±–æ—Ç –Ω–∞ 2026 –≥–æ–¥ —Å —É—á–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏."

–ü—Ä–∏–º–µ—Ä—ã –ü–†–û–°–¢–´–• –∏ –ü–û–ù–Ø–¢–ù–´–• –æ—Ç–≤–µ—Ç–æ–≤ (–ù–ï –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–µ):
1. "–ü—Ä–æ–±–ª–µ–º–∞ –±—É–¥–µ—Ç —Ä–µ—à–µ–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –¥–Ω–µ–π. –ù–∞–ø—Ä–∞–≤–∏–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ 25 –Ω–æ—è–±—Ä—è."
2. "–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ. –û—Å–≤–µ—â–µ–Ω–∏–µ –≤ –ø–æ–¥—ä–µ–∑–¥–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ."
3. "–†–∞–±–æ—Ç—ã –ø–æ —Ä–µ–º–æ–Ω—Ç—É –¥–æ—Ä–æ–≥–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é."

–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û JSON –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
{{
    "is_bureaucratic": 0 –∏–ª–∏ 1,
    "confidence": "–≤—ã—Å–æ–∫–∞—è" –∏–ª–∏ "—Å—Ä–µ–¥–Ω—è—è" –∏–ª–∏ "–Ω–∏–∑–∫–∞—è",
    "reason": "–∫—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ",
    "complexity_score": —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 100 (–≥–¥–µ 0 - –ø—Ä–æ—Å—Ç–æ–π –æ—Ç–≤–µ—Ç, 100 - –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–π –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π)
}}

–¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞:
{text}

JSON:"""

    try:
        response = client.chat.completions.create(
            model=OPENAI_MODEL,
            messages=[
                {"role": "system", "content": "–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É —Ç–µ–∫—Å—Ç–æ–≤. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—Å—Ç —Å–ª–æ–∂–Ω—ã–º –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç–≤–µ—Ç–æ–º. –û—Ç–≤–µ—á–∞–π –¢–û–õ–¨–ö–û –≤–∞–ª–∏–¥–Ω—ã–º JSON –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞."},
                {"role": "user", "content": prompt},
            ],
            stream=False,
            temperature=0.1,
            max_tokens=200
        )
        
        answer = response.choices[0].message.content.strip()
        
        # –£–±–∏—Ä–∞–µ–º markdown —Ä–∞–∑–º–µ—Ç–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
        if answer.startswith("```json"):
            answer = answer[7:]
        if answer.startswith("```"):
            answer = answer[3:]
        if answer.endswith("```"):
            answer = answer[:-3]
        answer = answer.strip()
        
        # –ü–∞—Ä—Å–∏–º JSON
        try:
            result = json.loads(answer)
            is_bureaucratic_val = result.get("is_bureaucratic", 0)
            confidence = result.get("confidence", "–Ω–∏–∑–∫–∞—è")
            reason = result.get("reason", "")
            complexity_score = result.get("complexity_score", 0)
            
            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
            if is_bureaucratic_val not in [0, 1]:
                is_bureaucratic_val = 1 if is_bureaucratic_val > 0 else 0
            
            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º complexity_score
            try:
                complexity_score = int(complexity_score)
                if complexity_score < 0:
                    complexity_score = 0
                if complexity_score > 100:
                    complexity_score = 100
            except (ValueError, TypeError):
                complexity_score = 50 if is_bureaucratic_val == 1 else 0
            
            return {
                "is_bureaucratic": is_bureaucratic_val,
                "confidence": confidence,
                "reason": reason,
                "complexity_score": complexity_score,
                "success": True,
                "error": None
            }
        except json.JSONDecodeError:
            # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON, –ø—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            is_bureaucratic_val = 0
            confidence = "–Ω–∏–∑–∫–∞—è"
            complexity_score = 0
            
            answer_lower = answer.lower()
            if '"is_bureaucratic": 1' in answer_lower or '"is_bureaucratic":1' in answer_lower:
                is_bureaucratic_val = 1
                confidence = "—Å—Ä–µ–¥–Ω—è—è"
                complexity_score = 50
            elif '"is_bureaucratic": 0' in answer_lower or '"is_bureaucratic":0' in answer_lower:
                is_bureaucratic_val = 0
            elif "–±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π" in answer_lower or "—Å–ª–æ–∂–Ω—ã–π" in answer_lower or "–¥–∞" in answer_lower:
                is_bureaucratic_val = 1
                confidence = "—Å—Ä–µ–¥–Ω—è—è"
                complexity_score = 50
            
            return {
                "is_bureaucratic": is_bureaucratic_val,
                "confidence": confidence,
                "reason": "–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ",
                "complexity_score": complexity_score,
                "success": True,
                "error": None
            }
        
    except Exception as e:
        return {
            "is_bureaucratic": 0,
            "confidence": "–Ω–∏–∑–∫–∞—è",
            "reason": "–æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ",
            "complexity_score": 0,
            "success": False,
            "error": str(e)
        }


def analyze_batch_responses(texts: List[str]) -> List[Dict]:
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—Ç–≤–µ—Ç–æ–≤
    
    Args:
        texts: –°–ø–∏—Å–æ–∫ —Ç–µ–∫—Å—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
        
    Returns:
        –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
    """
    results = []
    for text in texts:
        result = is_bureaucratic_response(text)
        results.append(result)
    return results


def count_bureaucratic_responses(texts: List[str]) -> Dict:
    """
    –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–∂–Ω—ã—Ö –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ
    
    Args:
        texts: –°–ø–∏—Å–æ–∫ —Ç–µ–∫—Å—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:
        {
            "total": –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ,
            "bureaucratic_count": –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö,
            "percentage": –ø—Ä–æ—Ü–µ–Ω—Ç –±—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö,
            "results": —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
        }
    """
    if not texts:
        return {
            "total": 0,
            "bureaucratic_count": 0,
            "percentage": 0.0,
            "results": []
        }
    
    results = analyze_batch_responses(texts)
    bureaucratic_count = sum(1 for r in results if r.get("is_bureaucratic", 0) == 1)
    total = len(texts)
    percentage = (bureaucratic_count / total * 100) if total > 0 else 0.0
    
    return {
        "total": total,
        "bureaucratic_count": bureaucratic_count,
        "percentage": round(percentage, 2),
        "results": results
    }


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
if __name__ == "__main__":
    print("=" * 60)
    print("–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è bureaucratic_analyzer")
    print("=" * 60)
    
    test_responses = [
        "–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–µ–π—Å—Ç–≤—É—é—â–∏–º –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–æ–≤—ã–º–∏ –∞–∫—Ç–∞–º–∏, —Ä–µ–≥—É–ª–∏—Ä—É—é—â–∏–º–∏ –≤–æ–ø—Ä–æ—Å—ã –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–ª–∞–Ω–∞ —Ä–∞–±–æ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –æ—Ç—á–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥.",
        "–ü—Ä–æ–±–ª–µ–º–∞ –±—É–¥–µ—Ç —Ä–µ—à–µ–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –¥–Ω–µ–π. –ù–∞–ø—Ä–∞–≤–∏–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ 25 –Ω–æ—è–±—Ä—è.",
        "–ü–æ –≤–æ–ø—Ä–æ—Å—É, –∏–∑–ª–æ–∂–µ–Ω–Ω–æ–º—É –≤ –æ–±—Ä–∞—â–µ–Ω–∏–∏, —Å–æ–æ–±—â–∞–µ–º, —á—Ç–æ –≤ —Ä–∞–º–∫–∞—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é –æ–±—ä–µ–∫—Ç–æ–≤ –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –º–µ—Ä—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞.",
        "–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ. –û—Å–≤–µ—â–µ–Ω–∏–µ –≤ –ø–æ–¥—ä–µ–∑–¥–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.",
    ]
    
    print(f"\nüìù –ê–Ω–∞–ª–∏–∑ {len(test_responses)} –æ—Ç–≤–µ—Ç–æ–≤...\n")
    
    for i, response in enumerate(test_responses, 1):
        print(f"{i}. –û—Ç–≤–µ—Ç: {response[:80]}...")
        result = is_bureaucratic_response(response)
        bureaucratic_text = '–î–∞' if result['is_bureaucratic'] == 1 else '–ù–µ—Ç'
        print(f"   –ë—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π: {bureaucratic_text} (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {result['confidence']}, —Å–ª–æ–∂–Ω–æ—Å—Ç—å: {result['complexity_score']})")
        print(f"   –ü—Ä–∏—á–∏–Ω–∞: {result['reason']}\n")
    
    print("=" * 60)
    print("–ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:")
    print("=" * 60)
    stats = count_bureaucratic_responses(test_responses)
    print(f"–í—Å–µ–≥–æ –æ—Ç–≤–µ—Ç–æ–≤: {stats['total']}")
    print(f"–ë—é—Ä–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö: {stats['bureaucratic_count']}")
    print(f"–ü—Ä–æ—Ü–µ–Ω—Ç: {stats['percentage']}%")

